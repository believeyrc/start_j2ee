package com.xuyuan.ibatis;import java.io.Reader;import java.util.HashMap;import java.util.List;import java.util.Map;import com.ibatis.common.resources.Resources;import com.ibatis.sqlmap.client.SqlMapClient;import com.ibatis.sqlmap.client.SqlMapClientBuilder;import com.xuyuan.ibatis.model.User;import com.xuyuan.ibatis.util.ParameterMap;/** * HelloWorld 2 ibatis. * @author http://sarin.iteye.com/blog/677623 */public class HelloWorld {	public static void main(String[] args) throws Exception {		Reader reader = Resources.getResourceAsReader("ibatis.cfg.xml");          SqlMapClient sqlMap = SqlMapClientBuilder.buildSqlMapClient(reader);                 //查询所有--------------------------------------------------------------        //resultClass="User".User为实体类Bean的别名.        //因为查询方法为queryForList,所以返回值为:List<User>        List<User> userList = sqlMap.queryForList("getUsers");	//不能是user.getUsers.          for (User user : userList) {              System.out.println("getUsers>>" + user);          }          //resultMap="UserMap".UserMap为<resultMap class="Bean"> 返回值:List<User>        List<User> userList2 = sqlMap.queryForList("getUsers2");          for (User user : userList2) {              System.out.println("getUsers2>>" + user);          }                 //resultClass="java.util.HashMap".返回值:List<HashMap>        List<HashMap> userMap = sqlMap.queryForList("getUsers3");          for (HashMap user : userMap) {              System.out.println("getUsers3>>" + user);          }                //resultMap="UserMap2".UserMap为<resultMap class="java.util.HashMap"> 返回值:List<HashMap>        List<HashMap> userMap2 = sqlMap.queryForList("getUsers4");          for (HashMap user : userMap2) {          	System.out.println("getUsers4>>" + user);          }        //查询所有--------------------------------------------------------------                //带参查询--------------------------------------------------------------        //参数的类型要和user-sqlmap.xml的parameterClass一致.如果传递的参数值为1,报错java.sql.SQLException: Invalid parameter object type.        //queryForObject,则返回Object对象.Object可以根据resultClass或resultMap的返回类型进行转换成对象的类型.        User user = (User)sqlMap.queryForObject("selectByUserId", 1L);        System.out.println("selectById>>" + user);                //like查询,'%$username$%' $和#的区别.        userList = sqlMap.queryForList("selectByUserName","test1");          for (User usr : userList) {              System.out.println("selectByName>>" + usr);          }                //传递多个参数,参数类型为HashMap        Map map = new HashMap();        map.put("username", "test");        map.put("email", "cn");        userList = sqlMap.queryForList("selectByNameMail",map);          for (User usr : userList) {          	System.out.println("selectByNameMail>>" + usr);          }                  //自定义Map类型,方便传递参数        //因为ParameterMap继承于HashMap.配置文件中parameterClass="parameterMap"或者java.util.HashMap都可以        ParameterMap parameterMap = new ParameterMap("username", "test","email", "cn");          userList = sqlMap.queryForList("selectByNameMail_paramMap",parameterMap);          //userList = sqlMap.queryForList("selectByNameMail",parameterMap);	//It's OK too          for (User usr : userList) {          	System.out.println("selectByNameMail_paramMap>>" + usr);          }          //带参查询--------------------------------------------------------------                User usr = new User();        usr.setUsername("test25");        usr.setPassword("test25");        usr.setEmail("test5@g.cn");        Object obj = sqlMap.insert("insertUser",usr);        System.out.println("insertUser>>" + obj);                map = new HashMap();        map.put("username", "test11");        map.put("password", "test11");        map.put("email", "test11@g.cn");        Object res = sqlMap.insert("insertUser2",map);        System.out.println("insertUser2>>" + res);                //        User usr = new User();//        usr.setUsername("test3");//        usr.setEmail("");//        User usr2 = (User)sqlMap.queryForObject("selectByUser", usr);//        System.out.println("selectByUser>>" + usr2);        	}}